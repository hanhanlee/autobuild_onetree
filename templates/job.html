{% extends "_layout.html" %}
{% block title %}Job {{ job.id }}{% endblock %}
{% block content %}
    <h1>Job {{ job.id }}</h1>
    <p><a href="/new">New job</a></p>
    <div id="job" data-job-id="{{ job.id }}">
        <p>Status: <span id="job-status">{{ job.status }}</span></p>
        <p>Recipe: <code>{{ job.recipe_id or 'unknown' }}</code></p>
        <p>Created by: {{ job.created_by or job.owner }}</p>
        <p>Note: {% if job.note %}{{ job.note }}{% else %}-{% endif %}</p>
        <p>Created: {{ job.created_at }}{% if job.started_at %}, Started: {{ job.started_at }}{% endif %}{% if job.finished_at %}, Finished: {{ job.finished_at }}{% endif %}</p>
    </div>

    <h2>Recipe Snapshot</h2>
    <div class="card" style="max-width: 820px;">
        {% if job.raw_recipe_yaml %}
            <details open>
                <summary>raw_recipe_yaml</summary>
                <pre style="white-space:pre-wrap">{{ job.raw_recipe_yaml }}</pre>
            </details>
        {% else %}
            <p>No recipe captured for this job.</p>
        {% endif %}
    </div>

    <h2>Logs</h2>
    <pre id="log-output"></pre>

    <h2>Artifacts</h2>
    <ul id="artifact-list">
        {% for item in artifacts.values() %}
            <li><a href="/api/jobs/{{ job.id }}/artifacts/{{ item.name }}">{{ item.name }}</a> ({{ item.size }} bytes)</li>
        {% else %}
            <li>No artifacts yet.</li>
        {% endfor %}
    </ul>

    <script src="/static/app.js"></script>
{% endblock %}
